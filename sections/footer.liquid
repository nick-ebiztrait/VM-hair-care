{%- assign social_icons = false -%}

{% if
  settings.social_twitter_link != blank
  or settings.social_facebook_link != blank
  or settings.social_pinterest_link != blank
  or settings.social_google_link != blank
  or settings.social_pinterest_link != blank
  or settings.social_instagram_link != blank
  or settings.social_tumblr_link != blank
  or settings.social_snapchat_link != blank
  or settings.social_youtube_link != blank
  or settings.social_vimeo_link != blank
  or template.name == 'article'
  or template.name == 'blog'
%}
  {%- assign social_icons = true -%}
{% endif %}

<footer class="site-footer" role="contentinfo">
  
  {% if section.settings.footer_newsletter_enable %}
  	{% include 'EM3-Newsletter' %}
  {% endif %}
  
  <div class="page-width">
    <div class="grid grid--no-gutters">
      
      <div class="grid__item medium-up--one-quarter">
        <h4 class="footer-nav-title footer-title-one">{{ section.settings.footernav1_label | escape }}</h4>
        {%- assign footer_linklist = section.settings.footer_linklist -%}
        {% if linklists[footer_linklist].links.size > 0 %}
          <ul class="site-footer__linklist">
            {% for link in linklists[footer_linklist].links %}
              <li class="site-footer__linklist-item">
                <a href="{{ link.url }}">{{ link.title }}</a>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </div>
     
      <div class="grid__item medium-up--one-quarter">
        <h4 class="footer-nav-title footer-title-two">{{ section.settings.footernav2_label | escape }}</h4>
        {%- assign footer_linklist_two = section.settings.footer_linklist_two -%}
        {% if linklists[footer_linklist_two].links.size > 0 %}
          <ul class="site-footer__linklist">
            {% for link in linklists[footer_linklist_two].links %}
              <li class="site-footer__linklist-item">
                <a href="{{ link.url }}">{{ link.title }}</a>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </div>
      <div class="grid__item medium-up--one-quarter">
        <h4 class="footer-nav-title footer-title-three">{{ section.settings.footernav3_label | escape }}</h4>
        {%- assign footer_linklist_three = section.settings.footer_linklist_three -%}
        {% if linklists[footer_linklist_three].links.size > 0 %}
          <ul class="site-footer__linklist">
            {% for link in linklists[footer_linklist_three].links %}
              <li class="site-footer__linklist-item">
                <a href="{{ link.url }}">{{ link.title }}</a>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </div>
      {% if section.settings.image-footer != blank %}
      <div class="grid__item medium-up--one-quarter">
        {% if section.settings.imagelink != blank %}
         
          <a href="{{ section.settings.imagelink-footer }}">
            <img class="footer-image" src="{{ section.settings.image-footer | img_url: '250x250' }}">
          </a>
        
        {% else %}
        
       	 <img class="footer-image" src="{{ section.settings.image-footer | img_url: '250x250' }}">
        
        {% endif %}

        
        {% if section.blocks.size > 0 %}
        	<div class="footer-content">
             {% for block in section.blocks %}

              {% case block.type %}

             {% when 'text' %}
                <div class="footer-text" {{ block.shopify_attributes }}>
                  {{ block.settings.text }}
                </div>

              {% when 'html' %}
                <div class="footer-code" {{ block.shopify_attributes }}>
                  {{ block.settings.code }}
                </div>
              {% endcase %}

            {% endfor %}
        </div>
        {% endif %}
        
      </div>
      
      {% elsif section.blocks.size > 0 %}
      
      	{% if section.blocks.size > 0 %}
        	<div class="footer-content">
             {% for block in section.blocks %}

              {% case block.type %}

             {% when 'text' %}
                <div class="footer-text" {{ block.shopify_attributes }}>
                  {{ block.settings.text }}
                </div>

              {% when 'html' %}
                <div class="footer-code" {{ block.shopify_attributes }}>
                  {{ block.settings.code }}
                </div>
              {% endcase %}

            {% endfor %}
        </div>
        {% endif %}

      {% endif %}
    </div>

    <div class="grid grid--no-gutters">
      {% if social_icons %}
        <div class="grid__item medium-up--one-half">
          <ul class="list--inline site-footer__social-icons social-icons">
            {% if settings.social_facebook_link != blank %}
              <li>
                <a class="social-icons__link" href="{{ settings.social_facebook_link | escape }}" title="{{ 'layout.footer.social_platform' | t: name: shop.name, platform: 'Facebook' }}">
                  {% include 'icon-facebook' %}
                  <span class="icon__fallback-text">Facebook</span>
                </a>
              </li>
            {% endif %}
            {% if settings.social_twitter_link != blank %}
              <li>
                <a class="social-icons__link" href="{{ settings.social_twitter_link | escape }}" title="{{ 'layout.footer.social_platform' | t: name: shop.name, platform: 'Twitter' }}">
                  {% include 'icon-twitter' %}
                  <span class="icon__fallback-text">Twitter</span>
                </a>
              </li>
            {% endif %}
            {% if settings.social_google_link != blank %}
              <li>
                <a class="social-icons__link" href="{{ settings.social_google_link | escape }}" title="{{ 'layout.footer.social_platform' | t: name: shop.name, platform: 'Twitter' }}">
                  {% include 'icon-google' %}
                  <span class="icon__fallback-text">Google</span>
                </a>
              </li>
            {% endif %}
            {% if settings.social_pinterest_link != blank %}
              <li>
                <a class="social-icons__link" href="{{ settings.social_pinterest_link | escape }}" title="{{ 'layout.footer.social_platform' | t: name: shop.name, platform: 'Pinterest' }}">
                  {% include 'icon-pinterest' %}
                  <span class="icon__fallback-text">Pinterest</span>
                </a>
              </li>
            {% endif %}
            {% if settings.social_instagram_link != blank %}
              <li>
                <a class="social-icons__link" href="{{ settings.social_instagram_link | escape }}" title="{{ 'layout.footer.social_platform' | t: name: shop.name, platform: 'Instagram' }}">
                  {% include 'icon-instagram' %}
                  <span class="icon__fallback-text">Instagram</span>
                </a>
              </li>
            {% endif %}
            {% if settings.social_tumblr_link != blank %}
              <li>
                <a class="social-icons__link" href="{{ settings.social_tumblr_link | escape }}" title="{{ 'layout.footer.social_platform' | t: name: shop.name, platform: 'Tumblr' }}">
                  {% include 'icon-tumblr' %}
                  <span class="icon__fallback-text">Tumblr</span>
                </a>
              </li>
            {% endif %}
            {% if settings.social_snapchat_link != blank %}
              <li>
                <a class="social-icons__link" href="{{ settings.social_snapchat_link | escape }}" title="{{ 'layout.footer.social_platform' | t: name: shop.name, platform: 'Snapchat' }}">
                  {% include 'icon-snapchat' %}
                  <span class="icon__fallback-text">Snapchat</span>
                </a>
              </li>
            {% endif %}
            {% if settings.social_youtube_link != blank %}
              <li>
                <a class="social-icons__link" href="{{ settings.social_youtube_link | escape }}" title="{{ 'layout.footer.social_platform' | t: name: shop.name, platform: 'YouTube' }}">
                  {% include 'icon-youtube' %}
                  <span class="icon__fallback-text">YouTube</span>
                </a>
              </li>
            {% endif %}
            {% if settings.social_vimeo_link != blank %}
              <li>
                <a class="social-icons__link" href="{{ settings.social_vimeo_link | escape }}" title="{{ 'layout.footer.social_platform' | t: name: shop.name, platform: 'Vimeo' }}">
                  {% include 'icon-vimeo' %}
                  <span class="icon__fallback-text">Vimeo</span>
                </a>
              </li>
            {% endif %}
            {% if template.name == 'blog' or template.name == 'article' %}
              <li>
                <a class="social-icons__link" href="{{ shop.url }}{{ blog.url }}.atom">
                  {% include 'icon-rss' %}
                  <span class="icon__fallback-text">RSS</span>
                </a>
              </li>
            {% endif %}
          </ul>
        </div>
      {% endif %}

      <div class="grid__item{% if section.settings.footer_newsletter_enable and social_icons == true %} medium-up--one-half{% else %} text-center{% endif %}">
        <div class="site-footer__copyright{% if social_icons and section.settings.footer_newsletter_enable != blank %} site-footer__copyright--right medium-up--text-right{% elsif social_icons == false and section.settings.footer_newsletter_enable %} medium-up--text-left{% endif %}">
          {% unless social_icons and section.settings.footer_newsletter_enable and section.settings.show_payment_icons %}
            <small class="site-footer__copyright-content">&copy; {{ 'now' | date: "%Y" }}, {{ shop.name | link_to: '/' }}</small>
          {% endunless %}
          {% if section.settings.show_payment_icons %}
            <div class="site-footer__payment-icons{% unless social_icons or section.settings.footer_newsletter_enable == blank %} site-footer__payment-icons--right{% endunless %}">
              {% unless shop.enabled_payment_types == empty %}
                {%- assign payment_icons_available = 'amazon_payments,american_express,apple_pay,bitcoin,cirrus,dankort,diners_club,discover,dogecoin,dwolla,forbrugsforeningen,interac,jcb,litecoin,maestro,master,paypal,stripe,visa' | split: ',' -%}
                <ul class="payment-icons list--inline">
                  {% for type in shop.enabled_payment_types %}
                    {% if payment_icons_available contains type %}
                      <li class="payment-icon">
                        {%- assign icon_name = type | prepend: 'icon-' -%}
                        {% include icon_name %}
                      </li>
                    {% endif %}
                  {% endfor %}
                </ul>
              {% endunless %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>
    {% if social_icons and section.settings.footer_newsletter_enable and section.settings.show_payment_icons %}
      <div class="site-footer__copyright--bottom">
        <small class="site-footer__copyright-content">&copy; {{ 'now' | date: "%Y" }}, {{ shop.name | link_to: '/' }}</small>
      </div>
    {% endif %}
  </div>
</footer>

{% schema %}
  {
    "name": "Footer",
    "max_blocks": 2,
    "settings": [
      {
            "type": "text",
            "id": "footernav1_label",
            "label": "Navigation Label"
      },
      {
        "type": "link_list",
        "id": "footer_linklist",
        "label": "Primary menu",
        "default": "footer"
      },
      {
            "type": "text",
            "id": "footernav2_label",
            "label": "Navigation Label"
      },
      {
        "type": "link_list",
        "id": "footer_linklist_two",
        "label": "Additional menu",
        "default": "main-menu"
      },
      {
            "type": "text",
            "id": "footernav3_label",
            "label": "Navigation Label"
      },
      {
        "type": "link_list",
        "id": "footer_linklist_three",
        "label": "Additional menu",
        "default": "main-menu"
      },
      {
            "type": "image_picker",
            "id": "image-footer",
            "label": "Bottom Right Image (250px X 250px)"
      },
      {
            "type": "url",
            "id": "imagelink",
            "label": "Image Link",
            "info": "Optional"
	  },
      {
        "type": "checkbox",
        "id": "footer_newsletter_enable",
        "label": "Show newsletter signup",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "show_payment_icons",
        "label": "Show payment icons",
        "default": false
      }
    ],
	"blocks": [
	  {
		"type": "text",
		"name": "Footer Text Area",
		"settings": [
			{
				"type": "richtext",
				"id": "text",
				"label": "Text",
				"default": "<p>Use this text to share information about your brand with your customers. Describe a product, share announcements, or welcome customers to your store.</p>"
		 	}		
		 ]
	  },
      {
        "type": "html",
        "name": "Footer HTML Block",
        "settings": [
          {
            "type": "html",
            "id": "code",
            "label": "HTML",
            "info": "Displays in 4th column under logo (if present). Great For Trust Badges, etc."
          }
        ]
      }
    ]

  }

{% endschema %}
